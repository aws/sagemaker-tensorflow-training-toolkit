THE SYNTHETIC DATA IS GENERATED INSIDE THE MODEL AND TRAINING FUNCTIONS